/**
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 * START ORCHESTRATOR - Script de Inicio del Orquestador
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 * 
 * Inicia el orquestador de subagentes con los subagentes existentes.
 * Usa Opus 4.5 (mejor modelo) cuando est√© disponible.
 */

const { getOrchestrator } = require('./agent-orchestrator');

console.log('\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó');
console.log('‚ïë     ORQUESTADOR DE SUBAGENTES - OPUS 4.5                      ‚ïë');
console.log('‚ïë     Sistema de Monitoreo y Correcci√≥n Autom√°tica              ‚ïë');
console.log('‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n');

const orchestrator = getOrchestrator();

// Event listeners
orchestrator.on('started', () => {
  console.log('\n‚úÖ Orquestador iniciado correctamente');
  console.log('üìä Monitores activos:');
  for (const [id, monitor] of orchestrator.monitors) {
    if (monitor.intervalId) {
      console.log(`   ‚Ä¢ ${id} (cada ${monitor.interval}ms)`);
    }
  }
  console.log('\nüéØ Sistema monitoreando y corrigiendo autom√°ticamente...');
  console.log('   Presiona Ctrl+C para detener\n');
});

orchestrator.on('monitor-complete', ({ monitorId, errors }) => {
  if (errors > 0) {
    console.log(`‚ö†Ô∏è  [${monitorId}] ${errors} error(es) detectado(s)`);
  }
});

orchestrator.on('stopped', () => {
  console.log('\n‚úÖ Orquestador detenido correctamente\n');
});

// Manejar errores no capturados
process.on('unhandledRejection', (error) => {
  console.error('‚ùå Error no manejado:', error);
});

process.on('uncaughtException', (error) => {
  console.error('‚ùå Excepci√≥n no capturada:', error);
  orchestrator.stop();
  process.exit(1);
});

// Manejar se√±ales de cierre
process.on('SIGINT', () => {
  console.log('\n\nüõë Deteniendo orquestador...');
  orchestrator.stop();
  process.exit(0);
});

process.on('SIGTERM', () => {
  console.log('\n\nüõë Deteniendo orquestador...');
  orchestrator.stop();
  process.exit(0);
});

// Iniciar orquestador
orchestrator.start().catch((error) => {
  console.error('‚ùå Error iniciando orquestador:', error);
  process.exit(1);
});

